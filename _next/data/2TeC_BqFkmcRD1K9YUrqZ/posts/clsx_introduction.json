{"pageProps":{"post":"{\"slug\":\"clsx_introduction\",\"title\":\"Reactでよく使う classnames を置き換えるライブラリ。その名も「clsx」\",\"publishedAt\":\"2019-06-28T21:51:52.000Z\",\"description\":\"妥当classnamesとして作られた[clsx]というライブラリが登場していたので紹介してみます。\",\"tags\":[\"JavaScript\",\"React\"]}","content":"<h2 class=\"heading lv-2\">はじめに</h2>\n<p class=\"paragraph\">みなさんReactでクラス名を動的に設定する場合どうしてますか？\nほとんどの人が<code class=\"code\">classnames</code>というライブラリを使っているのではないでしょうか。</p>\n<p class=\"paragraph\">ここ最近その<code class=\"code\">classnames</code>を置き換えるようなライブラリが登場していたようなので紹介します。</p>\n<h4 class=\"heading lv-4\">classnames</h4>\n<p class=\"paragraph\">まずライブラリの紹介の前に比較対象である<code class=\"code\">classnames</code>についてですが\nReactを利用する人ならほぼ全員が知っているであろうライブラリです。\nというか<a href=\"https://reactjs.org/docs/faq-styling.html\" class=\"anchor\" rel=\"noopener noreferrer\" target=\"_blank\">公式で推奨</a>されてるんですね。</p>\n<p class=\"paragraph\"><a href=\"https://www.npmjs.com/package/classnames\" class=\"anchor\" rel=\"noopener noreferrer\" target=\"_blank\">https://www.npmjs.com/package/classnames</a></p>\n<h2 class=\"heading lv-2\">紹介</h2>\n<p class=\"paragraph\">ここからが本題</p>\n<h3 class=\"heading lv-3\">clsx</h3>\n<p class=\"paragraph\">今回紹介するのは <a href=\"https://www.npmjs.com/package/clsx\" class=\"anchor\" rel=\"noopener noreferrer\" target=\"_blank\">clsx</a> というライブラリです。\n<a href=\"https://www.npmjs.com/package/clsx\" class=\"anchor\" rel=\"noopener noreferrer\" target=\"_blank\">https://www.npmjs.com/package/clsx</a></p>\n<p class=\"paragraph\">今のバージョンは1.0.4でメジャーリリースは2018/12/25。\nつまり去年のクリスマス生まれのだいぶ新しいライブラリですね。:snowman2:\nnpmのインストールグラフを見る限り、今年の5月から爆発的に利用者が増えてきているライブラリです。</p>\n<p class=\"paragraph\">コンセプトは<strong>classnamesより小さく高速な代替品</strong>とのこと。</p>\n<p class=\"paragraph\">どうやらあの<code class=\"code\">material-ui</code>がバンドルサイズを小さくするためにこちらに移行したようで、\nそれが突然ダウンロード数が爆発した要因かと思われます。</p>\n<p class=\"paragraph\"><a href=\"https://material-ui.com/blog/material-ui-v4-is-out/\" class=\"anchor\" rel=\"noopener noreferrer\" target=\"_blank\">https://material-ui.com/blog/material-ui-v4-is-out/</a></p>\n<table class=\"table\">\n<thead class=\"thead\">\n<tr class=\"tr\">\n<th class=\"th\"></th>\n<th class=\"th\">GitHub Star</th>\n<th class=\"th\">サイズ(minifed)</th>\n<th class=\"th\">サイズ（+gzip)</th>\n<th class=\"th\">参考</th>\n</tr>\n</thead>\n<tbody class=\"tbody\">\n<tr class=\"tr\">\n<td class=\"td\">classnames</td>\n<td class=\"td\">10,781</td>\n<td class=\"td\">588B</td>\n<td class=\"td\">371B</td>\n<td class=\"td\"><a href=\"https://bundlephobia.com/result?p=classnames@2.2.6\" class=\"anchor\" rel=\"noopener noreferrer\" target=\"_blank\">リンク</a></td>\n</tr>\n<tr class=\"tr\">\n<td class=\"td\">clsx</td>\n<td class=\"td\">467</td>\n<td class=\"td\">512B</td>\n<td class=\"td\">306B</td>\n<td class=\"td\"><a href=\"https://bundlephobia.com/result?p=clsx@1.0.4\" class=\"anchor\" rel=\"noopener noreferrer\" target=\"_blank\">リンク</a></td>\n</tr>\n</tbody>\n</table>\n<p class=\"paragraph\">バンドルサイズについてgzip時は306Bと<code class=\"code\">classnames</code>よりも18%(65B)ほど小さくなっております。</p>\n<h4 class=\"heading lv-4\">使い方</h4>\n<p class=\"paragraph\">以下公式のコピペ</p>\n<div class=\"remark-highlight\"><pre class=\"language-js pre\"><code class=\"language-js code\"><span class=\"token keyword module\">import</span> <span class=\"token imports\">clsx</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'clsx'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Strings (variadic)</span>\n<span class=\"token function\">clsx</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span> <span class=\"token operator\">&#x26;&#x26;</span> <span class=\"token string\">'bar'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'baz'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//=> 'foo bar baz'</span>\n\n<span class=\"token comment\">// Objects</span>\n<span class=\"token function\">clsx</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> foo<span class=\"token operator\">:</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> bar<span class=\"token operator\">:</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> baz<span class=\"token operator\">:</span><span class=\"token function\">isTrue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//=> 'foo baz'</span>\n\n<span class=\"token comment\">// Objects (variadic)</span>\n<span class=\"token function\">clsx</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> foo<span class=\"token operator\">:</span><span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> bar<span class=\"token operator\">:</span><span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">'--foobar'</span><span class=\"token operator\">:</span><span class=\"token string\">'hello'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//=> 'foo --foobar'</span>\n\n<span class=\"token comment\">// Arrays</span>\n<span class=\"token function\">clsx</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bar'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//=> 'foo bar'</span>\n\n<span class=\"token comment\">// Arrays (variadic)</span>\n<span class=\"token function\">clsx</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bar'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">'baz'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">'hello'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'there'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//=> 'foo bar baz hello there'</span>\n\n<span class=\"token comment\">// Kitchen sink (with nesting)</span>\n<span class=\"token function\">clsx</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span> <span class=\"token operator\">&#x26;&#x26;</span> <span class=\"token string\">'bar'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> baz<span class=\"token operator\">:</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> bat<span class=\"token operator\">:</span><span class=\"token keyword null nil\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'hello'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'world'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cya'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//=> 'foo bar hello world cya'</span>\n</code></pre></div>\n<p class=\"paragraph\">Usageの癖が強いぃ！\nやりたいことはわかりますがUsageにしてはトリッキー過ぎてスッと入ってこない・・・\n一言で言うとおそらく<code class=\"code\">classnames</code>の完全互換です。（普段使いする分には実証済み）</p>\n<h4 class=\"heading lv-4\">ベンチマーク</h4>\n<div class=\"remark-highlight\"><pre class=\"language-unknown pre\"><code class=\"language-unknown code\"># Strings\n  classcat ≠   x  8,590,994 ops/sec ±0.27% (94 runs sampled)\n  classnames   x  3,987,311 ops/sec ±1.68% (94 runs sampled)\n  clsx         x 11,066,632 ops/sec ±0.23% (96 runs sampled)\n\n# Objects\n  classcat ≠   x 8,566,516 ops/sec ±0.42% (97 runs sampled)\n  classnames   x 3,697,182 ops/sec ±1.31% (98 runs sampled)\n  clsx         x 7,147,168 ops/sec ±0.30% (95 runs sampled)\n\n# Arrays\n  classcat ≠   x 7,538,840 ops/sec ±0.56% (95 runs sampled)\n  classnames   x 1,697,776 ops/sec ±1.41% (97 runs sampled)\n  clsx         x 7,922,225 ops/sec ±0.18% (95 runs sampled)\n\n# Nested Arrays\n  classcat ≠   x 6,462,158 ops/sec ±0.22% (97 runs sampled)\n  classnames   x 1,201,570 ops/sec ±0.22% (96 runs sampled)\n  clsx         x 6,132,222 ops/sec ±0.49% (95 runs sampled)\n\n# Nested Arrays w/ Objects\n  classcat ≠   x 6,277,187 ops/sec ±0.62% (93 runs sampled)\n  classnames   x 1,613,328 ops/sec ±1.69% (96 runs sampled)\n  clsx         x 5,156,844 ops/sec ±0.22% (95 runs sampled)\n\n# Mixed\n  classcat ≠   x 7,073,536 ops/sec ±0.26% (95 runs sampled)\n  classnames   x 2,149,952 ops/sec ±1.24% (95 runs sampled)\n  clsx         x 5,577,715 ops/sec ±0.20% (93 runs sampled)\n\n# Mixed (Bad Data)\n  classcat ≠   x 1,770,852 ops/sec ±0.14% (97 runs sampled)\n  classnames   x 1,148,353 ops/sec ±0.54% (97 runs sampled)\n  clsx         x 1,887,010 ops/sec ±0.14% (96 runs sampled)</code></pre></div>\n<p class=\"paragraph\">今回の主役<code class=\"code\">clsx</code>ですが<code class=\"code\">classnames</code>と比べた結果、差が大きいものでは５倍近くのパフォーマンスがでるようです。</p>\n<p class=\"paragraph\"><strong>ちなみに</strong>\nここで<code class=\"code\">classcat</code>というライブラリが比較対象に含まれていますね。\nこちらはコンセプトは同じ「打倒<code class=\"code\">classnames</code>」なのですがAPIの互換性がないライブラリなので\nこの記事では扱わないことにしています（興味がある方は調べてみてください）</p>\n<h2 class=\"heading lv-2\">まとめ</h2>\n<p class=\"paragraph\">個人的な感想としては使ってみてもいいかな？という感じです。</p>\n<p class=\"paragraph\">が、正直なところ置き換えるメリットもそれほど大きくないですし、\nなにより<code class=\"code\">classnames</code>に依存しているライブラリが山ほどあるので、\n<code class=\"code\">classnames</code>がデファクトスタンダードから引きずり降ろされることもないと思います。\n（つまりタイトルは煽りです:sweat_smile:）</p>\n<p class=\"paragraph\">ちなみに<code class=\"code\">classnames</code>のIssueに[「clsxっていうのが最近出てきたけどこのままでよいのか?」]\n(<a href=\"https://github.com/JedWatson/classnames/issues/187)%E3%81%A8%E3%81%84%E3%81%A3%E3%81%9F%E7%89%A9%E3%82%82%E3%81%82%E3%82%8A%E3%80%81\" class=\"anchor\" rel=\"noopener noreferrer\" target=\"_blank\">https://github.com/JedWatson/classnames/issues/187)といった物もあり、</a>\nひょっとするとclassnamesの性能がこれからまた上がるかも知れませんね。</p>\n<p class=\"paragraph\">こうやって対抗ライブラリが出てきては比較して〜というのは面白いし学びもあるので、\nみなさんも普段使っているライブラリに他の似たものがないか調べてみてはいかがでしょうか？</p>\n<hr>\n<p class=\"paragraph\">おしまい</p>"},"__N_SSG":true}