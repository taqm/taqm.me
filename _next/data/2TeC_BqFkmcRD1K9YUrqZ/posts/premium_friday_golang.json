{"pageProps":{"post":"{\"slug\":\"premium_friday_golang\",\"title\":\"ひさしぶりのプレミアムフライデー（GO言語）\",\"publishedAt\":\"2018-11-30T09:48:37.000Z\",\"description\":\"プレミアムフライデーを判定する処理をGo言語で書いて見たため紹介&解説します。\",\"tags\":[\"Golang\"]}","content":"<h2 class=\"heading lv-2\">はじめに</h2>\n<p class=\"paragraph\">気づけば今日はプレミアムフライデーです（死語？）\nせっかくなので久しぶりにプレミアムフライデーを求める処理を書いてみます。</p>\n<h2 class=\"heading lv-2\">コード</h2>\n<h3 class=\"heading lv-3\">メイン</h3>\n<div class=\"has-filename\"><div class=\"filename\">main.go</div><pre class=\"language-go pre\"><code class=\"language-go code\"><span class=\"token keyword\">package</span> main\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span>\n\t<span class=\"token string\">\"fmt\"</span>\n\t<span class=\"token string\">\"strconv\"</span>\n\t<span class=\"token string\">\"time\"</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\tr <span class=\"token operator\">:=</span> <span class=\"token function\">GetPremiumFriday</span><span class=\"token punctuation\">(</span><span class=\"token number\">2018</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">GetPremiumFriday</span><span class=\"token punctuation\">(</span>year <span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> month <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> time<span class=\"token punctuation\">.</span>Time <span class=\"token punctuation\">{</span>\n\tl <span class=\"token operator\">:=</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Date</span><span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Month</span><span class=\"token punctuation\">(</span>month<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span>UTC<span class=\"token punctuation\">)</span>\n\tw <span class=\"token operator\">:=</span> l<span class=\"token punctuation\">.</span><span class=\"token function\">Weekday</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\tdh <span class=\"token operator\">:=</span> strconv<span class=\"token punctuation\">.</span><span class=\"token function\">Itoa</span><span class=\"token punctuation\">(</span><span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token punctuation\">(</span>w<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">%</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span>\n\td<span class=\"token punctuation\">,</span> <span class=\"token boolean\">_</span> <span class=\"token operator\">:=</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">ParseDuration</span><span class=\"token punctuation\">(</span>dh <span class=\"token operator\">+</span> <span class=\"token string\">\"h\"</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">return</span> l<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h4 class=\"heading lv-4\">解説</h4>\n<p class=\"paragraph\">あまり説明もないですが<code class=\"code\">time</code>パッケージを使っています。\n<code class=\"code\">time.Date</code>関数の引数部分にある<strong>日付部分</strong>に0を渡すことで前月の末日が設定されます。\nなので受け取った月＋１を設定して設定した月の末日を取得しました。</p>\n<p class=\"paragraph\"><code class=\"code\">ParseDuration</code>へ文字列で期間を渡すことで、シンプルに日付の減算が可能なのですが、\n最大単位が<strong>Hour</strong>のようなのでちょこっとだけ計算を行っています。</p>\n<h3 class=\"heading lv-3\">テスト</h3>\n<p class=\"paragraph\">せっかく標準でテスト機構が備わっているのでどんどん使っていきましょう！\nVSCodeだとコード上で<code class=\"code\">run test</code>できるのでこういう時すごく便利です</p>\n<div class=\"has-filename\"><div class=\"filename\">main_test.go</div><pre class=\"language-go pre\"><code class=\"language-go code\"><span class=\"token keyword\">package</span> main\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span>\n\t<span class=\"token string\">\"testing\"</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">type</span> Fixture <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\tYaer      <span class=\"token builtin\">int</span>\n\tMonth     <span class=\"token builtin\">int</span>\n\tExpectDay <span class=\"token builtin\">int</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> fixtures <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>Fixture<span class=\"token punctuation\">{</span>\n\tFixture<span class=\"token punctuation\">{</span><span class=\"token number\">2016</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\tFixture<span class=\"token punctuation\">{</span><span class=\"token number\">2018</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\tFixture<span class=\"token punctuation\">{</span><span class=\"token number\">2018</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\tFixture<span class=\"token punctuation\">{</span><span class=\"token number\">2018</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\tFixture<span class=\"token punctuation\">{</span><span class=\"token number\">2018</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\tFixture<span class=\"token punctuation\">{</span><span class=\"token number\">2019</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">TestGetPremiumFriday</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">*</span>testing<span class=\"token punctuation\">.</span>T<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">for</span> <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> f <span class=\"token operator\">:=</span> <span class=\"token keyword\">range</span> fixtures <span class=\"token punctuation\">{</span>\n\t\td <span class=\"token operator\">:=</span> <span class=\"token function\">GetPremiumFriday</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>Yaer<span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">.</span>Month<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Day</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">if</span> d <span class=\"token operator\">!=</span> f<span class=\"token punctuation\">.</span>ExpectDay <span class=\"token punctuation\">{</span>\n\t\t\tt<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p class=\"paragraph\">#　まとめ\nやってみたかっただけでした\nそのうちシャイニングマンデーもやるかな</p>\n<p class=\"paragraph\">おしまい</p>"},"__N_SSG":true}